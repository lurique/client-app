<div>
  <modal :title="text.title" effect="fade" width="800" v-model="showModal" @closed="closed">

    <template v-if="create">
      <p>
        Configure yours connections, <br>you able to use multiple connections with single datacenter.
        <button class="btn btn-warning btn-sm pull-right" @click="createLoad" v-if="provider">Back</button>
      </p>

      <list-options :lists="providers" @click="callStep" v-if="!provider"></list-options>

      <form class="row">

        <h3 class="col-xs-12" v-if="provider">
          <i :class="toIcon"></i>
          <span class="text-uppercase">{{provider}}</span>
        </h3>

        <template v-if="provider == 'AWS'">
          <div class="col-xs-6">
            <p>
              Please add your AWS Access Key ID and Secret Access Key.
            </p>

            <bs-select v-if="dcs.length > 0" :options="dcs" v-model="data.conn.dc"
                       label="Datacenter" placeholder="Select Datacenter" @input="updateProvider"
                       ref="s_provider"></bs-select>

            <bs-select :disabled="this.regions.length == 0" :options="regions" v-model="data.conn.regions"
                       label="Regions" placeholder="Select Regions" multiple></bs-select>

            <bs-input class="mt20" name="access" label="AWS AccessKey ID*" v-model="data.conn.access"
                      v-validate.initial="'required'" :error="makeError('access')"></bs-input>

            <bs-input type="password" class="mt20" name="secret" label="AWS SecretAccess Key*" v-model="data.conn.secret"
                      v-validate.initial="'required'" :error="makeError('secret')"></bs-input>


          </div>
          <div class="col-xs-6">
            <p>
              Just copy the following code and paste it under your Policy Document at AWS Console.
            </p>
            <div class="well">
              <small>
                {
                "Version": "2012-10-17",
                "Statement": [
                {
                "Effect": "Allow",
                "Action": [
                "ec2:RunInstances",
                "ec2:AssociateIamInstanceProfile",
                "ec2:ReplaceIamInstanceProfileAssociation"
                ],
                "Resource": "*"
                },
                {
                "Effect": "Allow",
                "Action": "iam:PassRole",
                "Resource": "*"
                }
                ]
                }
              </small>
            </div>
          </div>
          <div class="col-xs-12">
            <h4>Permission required</h4>
            <table class="table table-striped">
              <tbody>
              <tr v-for="perm in permission.AWS">
                <th>{{perm.name}}</th>
                <td>{{perm.desc}}</td>
                <td>{{perm.used}}</td>
              </tr>
              </tbody>
            </table>
          </div>
        </template>

        <template v-if="provider == 'OpenStack'">

        </template>


      </form>
    </template>

    <div class="well" v-if="!create">
      This connection use
      <i :class="toIcon"></i>
      <strong>{{provider}} provider</strong>, created at {{model.created_at}},
      if you like to update, please delete this connection and create a new one.
      <br>Don't forget to update any entity associated with this connection like datacenters.
    </div>


    <div slot="modal-footer" class="modal-footer">
      <button type="button" class="btn btn-default" @click="closed">Cancel</button>
      <button type="button" class="btn btn-primary" @click="actionClick"
              :disabled="!create">Save
      </button>
    </div>

  </modal>
</div>
